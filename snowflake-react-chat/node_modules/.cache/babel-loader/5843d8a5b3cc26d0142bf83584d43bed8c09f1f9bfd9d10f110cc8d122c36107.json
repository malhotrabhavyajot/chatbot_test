{"ast":null,"code":"var _jsxFileName = \"/workspaces/chatbot_test/snowflake-react-chat/src/components/ChatBot.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport '../styles/style.css';\nimport ChatbotIcon from '../assets/chatbot-toggler.png';\nimport ZSIcon from '../assets/ZS_Associates.png';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst HARDCODED_ANSWERS = {\n  \"where can i find top 10 gainer prescriber over time?\": \"Top 10 Gainer Prescribers can be found in the Performance Dossier.\",\n  \"what is formulary status?\": \"Formulary Status is the 'MMIT Pharmacy field which shows Preferred/Covered combined with PA/ST Restrictions.\",\n  \"what are the number of current monthly suggestion kpi?\": \"It is the 'Count of monthly suggestions (Call and RTE) for a prescriber.\",\n  \"which dossier gives a detailed analysis about the payors?\": \"You can find detailed analysis about Payor data in the Payor Highlights dossier.\",\n  \"where can i find explanations about different kpis?\": \"Explanations and Calculation of each and every KPI can be found in the Glossary dossier.\",\n  \"what is mkt % lis?\": \"Mkt % LIS is the Percentage of claims where claim type is 'PAID' and channel is 'Medicare' and 'Medicare D', and OPC = $0 - $12 and LIS patient flag = LIS-DE, LIS LTC, LIS-NON-DE, LIS-UNKNOWN for Rolling 3M.\",\n  \"which universes do we show in accounts calculation?\": \"We show three universes Veeva Aligned, Call Plan/DMCP and a combined Veeva Aligned + Call Plan/DMCP universes.\",\n  \"where can i find trx sales trends overtime?\": \"The sales trends for Retail and Non Retail sales can be found in the Performance Dossier.\"\n};\nfunction formatSnowflakeResponse(responseText) {\n  try {\n    let json = typeof responseText === 'string' ? JSON.parse(responseText) : responseText;\n    if (Array.isArray(json.data) && json.data.length > 0 && Array.isArray(json.data[0]) && typeof json.data[0][0] === 'string' && json.data[0][0].trim().startsWith('{')) {\n      const inner = JSON.parse(json.data[0][0]);\n      if (inner.output) return {\n        type: \"output\",\n        value: inner.output\n      };\n      return {\n        type: \"output\",\n        value: JSON.stringify(inner, null, 2)\n      };\n    }\n    if (json.output) return {\n      type: \"output\",\n      value: json.output\n    };\n    if (json.error) return {\n      type: \"error\",\n      value: \"‚ùå Error: \" + json.error\n    };\n    if (json.code && json.code !== \"000000\" && (!json.message || !json.message.toLowerCase().includes(\"executed successfully\"))) {\n      return {\n        type: \"error\",\n        value: `‚ùå Error: ${json.code} - ${json.message}`\n      };\n    }\n    if (json.message) return {\n      type: \"output\",\n      value: json.message\n    };\n    return {\n      type: \"output\",\n      value: \"No data found.\"\n    };\n  } catch {\n    return {\n      type: \"error\",\n      value: responseText || \"No response from backend.\"\n    };\n  }\n}\nfunction TypingIndicator() {\n  return /*#__PURE__*/_jsxDEV(\"span\", {\n    className: \"typing-indicator\",\n    children: [/*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 20\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 33\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 5\n  }, this);\n}\n_c = TypingIndicator;\nconst Tooltip = ({\n  children,\n  text\n}) => /*#__PURE__*/_jsxDEV(\"span\", {\n  className: \"feedback-tooltip\",\n  children: [children, /*#__PURE__*/_jsxDEV(\"span\", {\n    className: \"feedback-tooltiptext\",\n    children: text\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 56,\n  columnNumber: 3\n}, this);\n\n// ----------- QUICK REPLY CHIPS UTILS ----------------\n_c2 = Tooltip;\nfunction getSuggestedChips(assistantMsg) {\n  var _assistantMsg$text;\n  // Accepts { text } (string or obj)\n  const chips = [];\n  const msg = (assistantMsg === null || assistantMsg === void 0 ? void 0 : (_assistantMsg$text = assistantMsg.text) === null || _assistantMsg$text === void 0 ? void 0 : _assistantMsg$text.assistant_message) || (assistantMsg === null || assistantMsg === void 0 ? void 0 : assistantMsg.text) || \"\";\n  if (/metric/i.test(msg)) chips.push(\"TRx\", \"NBRx\");\n  if (/brand|product/i.test(msg)) chips.push(\"Exelon\", \"Risperidone\");\n  if (/geo|region|territory|ecosystem/i.test(msg)) chips.push(\"Region\", \"Territory\");\n  if (/time period|period|week|month|ytd/i.test(msg)) chips.push(\"CW\", \"R4W\", \"YTD\");\n  if (/channel/i.test(msg)) chips.push(\"Retail\", \"LTC\");\n  if (/age group/i.test(msg)) chips.push(\"18-64\", \"65+\");\n  // Remove duplicates\n  return [...new Set(chips)];\n}\n\n// Helper to check if assistant message is a clarifying message (bullets or numbered list)\nfunction isClarification(msg) {\n  var _msg$text;\n  // Check if text has multiple lines starting with - or numbers or a question mark.\n  const txt = ((_msg$text = msg.text) === null || _msg$text === void 0 ? void 0 : _msg$text.assistant_message) || msg.text || \"\";\n  const bulletLines = txt.split('\\n').filter(line => line.trim().match(/^(\\d+\\.|-)\\s+/));\n  return bulletLines.length > 0;\n}\n\n// ----------- DOWNLOAD HELPER ----------------\nfunction getMessageText(msg) {\n  var _msg$text$value;\n  if (typeof msg.text === \"string\") return msg.text;\n  if (msg.text && typeof msg.text === \"object\" && \"value\" in msg.text) return (_msg$text$value = msg.text.value) !== null && _msg$text$value !== void 0 ? _msg$text$value : JSON.stringify(msg.text);\n  if (msg.text != null) return JSON.stringify(msg.text);\n  return \"\";\n}\nfunction downloadChat(messages) {\n  const header = \"Field Insights Assistant - Chat Conversation\\n\\n\";\n  const chatText = messages.map(msg => `${msg.role === \"user\" ? \"User\" : \"Assistant\"}: ${getMessageText(msg)}`).join('\\n\\n');\n  const content = header + chatText;\n  const blob = new Blob([content], {\n    type: \"text/plain\"\n  });\n  const link = document.createElement(\"a\");\n  link.href = URL.createObjectURL(blob);\n  link.download = `chat-session-${new Date().toISOString().slice(0, 19).replace(/:/g, \"-\")}.txt`;\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n}\n\n// ----------- MAIN COMPONENT ----------------\nconst ChatBot = () => {\n  _s();\n  const [messages, setMessages] = useState(() => {\n    const saved = localStorage.getItem('chatMessages');\n    if (saved) return JSON.parse(saved);\n    return [{\n      role: 'assistant',\n      text: 'Hello üëã! How may I assist you?'\n    }];\n  });\n  const [feedback, setFeedback] = useState({});\n  const [input, setInput] = useState('');\n  const [isOpen, setIsOpen] = useState(false);\n  const [darkMode, setDarkMode] = useState(false);\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [toast, setToast] = useState({\n    message: '',\n    type: 'info',\n    visible: false\n  });\n  const [isTyping, setIsTyping] = useState(false);\n  const chatRef = useRef();\n  const inputRef = useRef();\n  useEffect(() => {\n    var _chatRef$current;\n    (_chatRef$current = chatRef.current) === null || _chatRef$current === void 0 ? void 0 : _chatRef$current.scrollTo({\n      top: chatRef.current.scrollHeight,\n      behavior: 'smooth'\n    });\n  }, [messages, isTyping, isOpen, isExpanded]);\n  useEffect(() => {\n    if (inputRef.current) {\n      inputRef.current.scrollLeft = inputRef.current.value.length * 8;\n    }\n  }, [input]);\n  useEffect(() => {\n    if (toast.visible) {\n      const timer = setTimeout(() => {\n        setToast(t => ({\n          ...t,\n          visible: false\n        }));\n      }, 1500);\n      return () => clearTimeout(timer);\n    }\n  }, [toast.visible]);\n  const showToast = (msg, type) => {\n    setToast({\n      message: msg,\n      type: type,\n      visible: true\n    });\n  };\n\n  // ----------- MAIN LOGIC ----------------\n  const handleSendMessage = async userMessage => {\n    if (!userMessage || typeof userMessage !== \"string\" || !userMessage.trim()) return;\n    setInput('');\n    setIsTyping(true);\n\n    // HARDCODED ANSWERS (instant, no LLM)\n    const cleaned = userMessage.trim().toLowerCase();\n    const matchedKey = Object.keys(HARDCODED_ANSWERS).find(k => cleaned.includes(k));\n    if (matchedKey) {\n      setIsTyping(false);\n      const updatedMessages = [...messages, {\n        role: 'user',\n        text: userMessage\n      }, {\n        role: 'assistant',\n        text: HARDCODED_ANSWERS[matchedKey]\n      }];\n      setMessages(updatedMessages);\n      localStorage.setItem('chatMessages', JSON.stringify(updatedMessages));\n      return;\n    }\n\n    // Always send message to clarify endpoint\n    const updatedMessages = [...messages, {\n      role: 'user',\n      text: userMessage\n    }];\n    setMessages(updatedMessages);\n    try {\n      const response = await fetch('http://localhost:4000/api/clarify', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          userMessage\n        })\n      });\n      const {\n        assistant_message,\n        finalized\n      } = await response.json();\n      if (finalized) {\n        // Show the final OpenAI prompt as a user message (right side)\n        setMessages(prev => [...prev, {\n          role: 'user',\n          text: assistant_message\n        }]);\n        setIsTyping(true);\n        let finalPrompt = assistant_message;\n        if (typeof finalPrompt === \"string\" && /^[\"‚Äú‚Äù'].*[\"‚Äú‚Äù']$/.test(finalPrompt.trim())) {\n          finalPrompt = finalPrompt.trim().replace(/^[\"‚Äú‚Äù']|[\"‚Äú‚Äù']$/g, \"\");\n        }\n        let body = {\n          statement: `CALL CUSTOM_AGENT2('${finalPrompt.replace(/'/g, \"''\")}')`\n        };\n        const snowflakeRes = await fetch('http://localhost:4000/api/snowflake', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(body)\n        });\n        const responseText = await snowflakeRes.text();\n        setIsTyping(false);\n\n        // Only show \"output\" from response\n        const formatted = formatSnowflakeResponse(responseText);\n        setMessages(prev => [...prev, {\n          role: \"assistant\",\n          text: formatted.value || \"No response.\"\n        }]);\n        return;\n      } else {\n        setIsTyping(false);\n        setMessages(prev => [...prev, {\n          role: 'assistant',\n          text: assistant_message\n        }]);\n        return;\n      }\n    } catch (error) {\n      setIsTyping(false);\n      setMessages(prev => [...prev, {\n        role: 'assistant',\n        text: \"Sorry, I couldn't process your query. Please try again.\"\n      }]);\n      return;\n    }\n  };\n  const handleFeedback = (idx, type) => {\n    setFeedback(prev => ({\n      ...prev,\n      [idx]: type\n    }));\n    showToast(type === \"up\" ? \"Marked as helpful!\" : \"Marked as not helpful!\", type === \"up\" ? \"success\" : \"error\");\n  };\n  const toggleTheme = () => setDarkMode(prev => !prev);\n  const renderChatBubbleContent = msg => {\n    if (typeof msg.text === \"object\" && msg.text !== null) {\n      if (msg.text.type === \"output\") return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: msg.text.value\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 46\n      }, this);\n      if (msg.text.type === \"error\") return /*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          color: \"#b91c1c\",\n          fontWeight: 500\n        },\n        children: msg.text.value\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 45\n      }, this);\n      return /*#__PURE__*/_jsxDEV(\"pre\", {\n        children: JSON.stringify(msg.text.value, null, 2)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 14\n      }, this);\n    }\n    return (msg.text || \"\").split('\\n').map((line, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: line\n    }, i, false, {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 7\n    }, this));\n  };\n\n  // ----------- CHIPS RENDER FUNCTION ----------------\n  const renderQuickReplies = (msg, idx) => {\n    // Only for clarification steps, don't show chips for final outputs\n    if (msg.role !== 'assistant' || !isClarification(msg)) return null;\n    const chips = getSuggestedChips(msg);\n    if (chips.length === 0) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chip-row\",\n      children: chips.map(chip => /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"suggestion-chip\",\n        onClick: () => handleSendMessage(chip),\n        children: chip\n      }, chip, false, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      background: 'linear-gradient(to bottom right, #f7faff, #e2ecf4)',\n      minHeight: '100vh'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"chatbot-toggler modern-toggler\",\n      onClick: () => setIsOpen(!isOpen),\n      \"aria-label\": \"Toggle chatbot\",\n      style: {\n        position: 'fixed',\n        right: '20px',\n        bottom: '20px',\n        zIndex: 10000\n      },\n      children: isOpen ? '‚úñ' : /*#__PURE__*/_jsxDEV(\"img\", {\n        src: ChatbotIcon,\n        alt: \"Chatbot\",\n        style: {\n          width: 48,\n          height: 48\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 25\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 7\n    }, this), isOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `chatbot modern-chatbot` + (darkMode ? ' dark-mode' : '') + (isExpanded ? ' expanded' : ' collapsed'),\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"chatbot-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"header-title\",\n          children: [\"Field Insights\", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"header-title-gradient\",\n            children: \" Assistant\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"header-controls\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"header-actions\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: toggleTheme,\n              title: \"Toggle theme\",\n              className: \"header-action-btn\",\n              \"aria-label\": \"Toggle theme\",\n              children: darkMode ? /*#__PURE__*/_jsxDEV(\"svg\", {\n                width: \"25\",\n                height: \"25\",\n                viewBox: \"0 0 24 24\",\n                fill: \"none\",\n                children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n                  cx: \"12\",\n                  cy: \"12\",\n                  r: \"5\",\n                  fill: \"#7c3aed\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 287,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"g\", {\n                  stroke: \"#7c3aed\",\n                  strokeWidth: \"2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"line\", {\n                    x1: \"12\",\n                    y1: \"2\",\n                    x2: \"12\",\n                    y2: \"5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 289,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                    x1: \"12\",\n                    y1: \"19\",\n                    x2: \"12\",\n                    y2: \"22\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 290,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                    x1: \"4.22\",\n                    y1: \"4.22\",\n                    x2: \"6.34\",\n                    y2: \"6.34\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 291,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                    x1: \"17.66\",\n                    y1: \"17.66\",\n                    x2: \"19.78\",\n                    y2: \"19.78\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 292,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                    x1: \"2\",\n                    y1: \"12\",\n                    x2: \"5\",\n                    y2: \"12\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 293,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                    x1: \"19\",\n                    y1: \"12\",\n                    x2: \"22\",\n                    y2: \"12\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 294,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                    x1: \"4.22\",\n                    y1: \"19.78\",\n                    x2: \"6.34\",\n                    y2: \"17.66\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 295,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                    x1: \"17.66\",\n                    y1: \"6.34\",\n                    x2: \"19.78\",\n                    y2: \"4.22\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 296,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 288,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 286,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n                width: \"25\",\n                height: \"25\",\n                viewBox: \"0 0 24 24\",\n                fill: \"none\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"M21 12.79A9 9 0 1111.21 3a7 7 0 0010.02 9.79z\",\n                  fill: \"#7c3aed\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 301,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 300,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 284,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                setMessages([{\n                  role: 'assistant',\n                  text: 'Hello üëã! How may I assist you?'\n                }]);\n                localStorage.removeItem('chatMessages');\n                setFeedback({});\n              },\n              title: \"Clear chat\",\n              className: \"header-action-btn\",\n              \"aria-label\": \"Clear chat\",\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                width: \"25\",\n                height: \"25\",\n                fill: \"none\",\n                stroke: \"#7c3aed\",\n                strokeWidth: \"2.1\",\n                viewBox: \"0 0 24 24\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"M4.93 4.93a10 10 0 1014.14 0M23 4v6h-6\",\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 316,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 315,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 305,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setIsExpanded(prev => !prev),\n              title: isExpanded ? 'Collapse window' : 'Expand window',\n              className: \"header-action-btn\",\n              \"aria-label\": isExpanded ? 'Collapse window' : 'Expand window',\n              children: isExpanded ? /*#__PURE__*/_jsxDEV(\"svg\", {\n                width: \"25\",\n                height: \"25\",\n                fill: \"none\",\n                stroke: \"#7c3aed\",\n                strokeWidth: \"2.1\",\n                viewBox: \"0 0 24 24\",\n                children: [/*#__PURE__*/_jsxDEV(\"polyline\", {\n                  points: \"8 3 3 3 3 8\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 327,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                  x1: \"3\",\n                  y1: \"3\",\n                  x2: \"10\",\n                  y2: \"10\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 328,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"polyline\", {\n                  points: \"16 21 21 21 21 16\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 329,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                  x1: \"21\",\n                  y1: \"21\",\n                  x2: \"14\",\n                  y2: \"14\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 330,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 326,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n                width: \"25\",\n                height: \"25\",\n                fill: \"none\",\n                stroke: \"#7c3aed\",\n                strokeWidth: \"2.1\",\n                viewBox: \"0 0 24 24\",\n                children: [/*#__PURE__*/_jsxDEV(\"polyline\", {\n                  points: \"15 3 21 3 21 9\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 334,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                  x1: \"21\",\n                  y1: \"3\",\n                  x2: \"14\",\n                  y2: \"10\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 335,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"polyline\", {\n                  points: \"9 21 3 21 3 15\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 336,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                  x1: \"3\",\n                  y1: \"21\",\n                  x2: \"10\",\n                  y2: \"14\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 337,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 333,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"chatbox\",\n        ref: chatRef,\n        children: [messages.map((msg, idx) => /*#__PURE__*/_jsxDEV(\"li\", {\n          className: `chat ${msg.role === 'user' ? 'outgoing' : 'incoming'}`,\n          style: {\n            justifyContent: msg.role === 'user' ? 'flex-end' : 'flex-start'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `chat-bubble ${msg.role}`,\n            children: renderChatBubbleContent(msg)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 17\n          }, this), msg.role === 'assistant' && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"feedback-row\",\n            children: [feedback[idx] === undefined && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(Tooltip, {\n                text: \"Mark as helpful\",\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"feedback-btn\",\n                  onClick: () => handleFeedback(idx, 'up'),\n                  \"aria-label\": \"Thumbs up\",\n                  tabIndex: 0,\n                  children: \"\\uD83D\\uDC4D\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 360,\n                  columnNumber: 27\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 359,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n                text: \"Mark as not helpful\",\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"feedback-btn\",\n                  onClick: () => handleFeedback(idx, 'down'),\n                  \"aria-label\": \"Thumbs down\",\n                  tabIndex: 0,\n                  children: \"\\uD83D\\uDC4E\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 368,\n                  columnNumber: 27\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 367,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true), feedback[idx] === 'up' && /*#__PURE__*/_jsxDEV(Tooltip, {\n              text: \"Marked as helpful!\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"feedback-btn selected up\",\n                \"aria-label\": \"Thumbs up\",\n                tabIndex: 0,\n                children: \"\\uD83D\\uDC4D\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 379,\n                columnNumber: 25\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 378,\n              columnNumber: 23\n            }, this), feedback[idx] === 'down' && /*#__PURE__*/_jsxDEV(Tooltip, {\n              text: \"Marked as not helpful\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"feedback-btn selected down\",\n                \"aria-label\": \"Thumbs down\",\n                tabIndex: 0,\n                children: \"\\uD83D\\uDC4E\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 384,\n                columnNumber: 25\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 383,\n              columnNumber: 23\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 19\n          }, this), renderQuickReplies(msg, idx)]\n        }, idx, true, {\n          fileName: _jsxFileName,\n          lineNumber: 346,\n          columnNumber: 15\n        }, this)), isTyping && /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"chat incoming\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"chat-bubble assistant\",\n            children: /*#__PURE__*/_jsxDEV(TypingIndicator, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 396,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 395,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-input\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          ref: inputRef,\n          placeholder: \"Ask me anything...\",\n          value: input,\n          onChange: e => setInput(e.target.value),\n          onKeyDown: e => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n              e.preventDefault();\n              handleSendMessage(input);\n            }\n          },\n          rows: 1,\n          className: \"chat-input-textarea\",\n          style: {\n            overflow: 'hidden',\n            resize: 'none'\n          },\n          disabled: isTyping,\n          autoFocus: isOpen,\n          \"aria-label\": \"Type your message\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleSendMessage(input),\n          title: \"Send message\",\n          className: `send-button${input.trim() ? \" has-text\" : \"\"}`,\n          disabled: isTyping || !input.trim(),\n          \"aria-label\": \"Send\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            height: \"22\",\n            width: \"22\",\n            viewBox: \"0 0 24 24\",\n            fill: \"none\",\n            style: {\n              display: \"block\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M4 20L20 12L4 4V10L16 12L4 14V20Z\",\n              fill: \"currentColor\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 428,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 427,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n        className: \"chatbot-footer\",\n        style: {\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          position: \"relative\",\n          width: \"100%\",\n          minHeight: \"40px\",\n          padding: \"8px 0\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => downloadChat(messages),\n          title: \"Download conversation\",\n          className: \"header-action-btn\",\n          \"aria-label\": \"Download chat\",\n          style: {\n            position: \"absolute\",\n            left: 0,\n            top: \"45%\",\n            transform: \"translateY(-50%)\",\n            background: \"none\",\n            border: \"none\",\n            cursor: \"pointer\",\n            padding: \"0 0 0 12px\",\n            height: \"100%\",\n            display: \"flex\",\n            alignItems: \"center\"\n          },\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            width: \"22\",\n            height: \"22\",\n            fill: \"none\",\n            viewBox: \"0 0 24 24\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M12 16v-8M12 16l-4-4M12 16l4-4M4 20h16\",\n              stroke: \"#7c3aed\",\n              strokeWidth: \"2\",\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 465,\n              columnNumber: 7\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 464,\n            columnNumber: 5\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 3\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\"\n          },\n          children: [\"Powered by \", /*#__PURE__*/_jsxDEV(\"img\", {\n            src: ZSIcon,\n            alt: \"ZS Associates\",\n            style: {\n              marginLeft: 5,\n              height: 25\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 470,\n            columnNumber: 16\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 469,\n          columnNumber: 3\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 1\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 262,\n    columnNumber: 5\n  }, this);\n};\n_s(ChatBot, \"+sV5U1fzuhKq3kTKc+Pf7jEFLBU=\");\n_c3 = ChatBot;\nexport default ChatBot;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"TypingIndicator\");\n$RefreshReg$(_c2, \"Tooltip\");\n$RefreshReg$(_c3, \"ChatBot\");","map":{"version":3,"names":["React","useEffect","useRef","useState","ChatbotIcon","ZSIcon","jsxDEV","_jsxDEV","Fragment","_Fragment","HARDCODED_ANSWERS","formatSnowflakeResponse","responseText","json","JSON","parse","Array","isArray","data","length","trim","startsWith","inner","output","type","value","stringify","error","code","message","toLowerCase","includes","TypingIndicator","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","Tooltip","text","_c2","getSuggestedChips","assistantMsg","_assistantMsg$text","chips","msg","assistant_message","test","push","Set","isClarification","_msg$text","txt","bulletLines","split","filter","line","match","getMessageText","_msg$text$value","downloadChat","messages","header","chatText","map","role","join","content","blob","Blob","link","document","createElement","href","URL","createObjectURL","download","Date","toISOString","slice","replace","body","appendChild","click","removeChild","ChatBot","_s","setMessages","saved","localStorage","getItem","feedback","setFeedback","input","setInput","isOpen","setIsOpen","darkMode","setDarkMode","isExpanded","setIsExpanded","toast","setToast","visible","isTyping","setIsTyping","chatRef","inputRef","_chatRef$current","current","scrollTo","top","scrollHeight","behavior","scrollLeft","timer","setTimeout","t","clearTimeout","showToast","handleSendMessage","userMessage","cleaned","matchedKey","Object","keys","find","k","updatedMessages","setItem","response","fetch","method","headers","finalized","prev","finalPrompt","statement","snowflakeRes","formatted","handleFeedback","idx","toggleTheme","renderChatBubbleContent","style","color","fontWeight","i","renderQuickReplies","chip","onClick","background","minHeight","position","right","bottom","zIndex","src","alt","width","height","title","viewBox","fill","cx","cy","r","stroke","strokeWidth","x1","y1","x2","y2","d","removeItem","strokeLinecap","strokeLinejoin","points","ref","justifyContent","undefined","tabIndex","placeholder","onChange","e","target","onKeyDown","key","shiftKey","preventDefault","rows","overflow","resize","disabled","autoFocus","display","alignItems","padding","left","transform","border","cursor","marginLeft","_c3","$RefreshReg$"],"sources":["/workspaces/chatbot_test/snowflake-react-chat/src/components/ChatBot.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport '../styles/style.css';\nimport ChatbotIcon from '../assets/chatbot-toggler.png';\nimport ZSIcon from '../assets/ZS_Associates.png';\n\nconst HARDCODED_ANSWERS = {\n  \"where can i find top 10 gainer prescriber over time?\": \"Top 10 Gainer Prescribers can be found in the Performance Dossier.\",\n  \"what is formulary status?\": \"Formulary Status is the 'MMIT Pharmacy field which shows Preferred/Covered combined with PA/ST Restrictions.\",\n  \"what are the number of current monthly suggestion kpi?\": \"It is the 'Count of monthly suggestions (Call and RTE) for a prescriber.\",\n  \"which dossier gives a detailed analysis about the payors?\": \"You can find detailed analysis about Payor data in the Payor Highlights dossier.\",\n  \"where can i find explanations about different kpis?\": \"Explanations and Calculation of each and every KPI can be found in the Glossary dossier.\",\n  \"what is mkt % lis?\": \"Mkt % LIS is the Percentage of claims where claim type is 'PAID' and channel is 'Medicare' and 'Medicare D', and OPC = $0 - $12 and LIS patient flag = LIS-DE, LIS LTC, LIS-NON-DE, LIS-UNKNOWN for Rolling 3M.\",\n  \"which universes do we show in accounts calculation?\": \"We show three universes Veeva Aligned, Call Plan/DMCP and a combined Veeva Aligned + Call Plan/DMCP universes.\",\n  \"where can i find trx sales trends overtime?\": \"The sales trends for Retail and Non Retail sales can be found in the Performance Dossier.\"\n};\n\nfunction formatSnowflakeResponse(responseText) {\n  try {\n    let json = typeof responseText === 'string' ? JSON.parse(responseText) : responseText;\n    if (\n      Array.isArray(json.data) &&\n      json.data.length > 0 &&\n      Array.isArray(json.data[0]) &&\n      typeof json.data[0][0] === 'string' &&\n      json.data[0][0].trim().startsWith('{')\n    ) {\n      const inner = JSON.parse(json.data[0][0]);\n      if (inner.output) return { type: \"output\", value: inner.output };\n      return { type: \"output\", value: JSON.stringify(inner, null, 2) };\n    }\n    if (json.output) return { type: \"output\", value: json.output };\n    if (json.error) return { type: \"error\", value: \"‚ùå Error: \" + json.error };\n    if (\n      json.code &&\n      json.code !== \"000000\" &&\n      (!json.message || !json.message.toLowerCase().includes(\"executed successfully\"))\n    ) {\n      return { type: \"error\", value: `‚ùå Error: ${json.code} - ${json.message}` };\n    }\n    if (json.message) return { type: \"output\", value: json.message };\n    return { type: \"output\", value: \"No data found.\" };\n  } catch {\n    return { type: \"error\", value: responseText || \"No response from backend.\" };\n  }\n}\n\nfunction TypingIndicator() {\n  return (\n    <span className=\"typing-indicator\">\n      <span></span><span></span><span></span>\n    </span>\n  );\n}\n\nconst Tooltip = ({ children, text }) => (\n  <span className=\"feedback-tooltip\">\n    {children}\n    <span className=\"feedback-tooltiptext\">{text}</span>\n  </span>\n);\n\n// ----------- QUICK REPLY CHIPS UTILS ----------------\nfunction getSuggestedChips(assistantMsg) {\n  // Accepts { text } (string or obj)\n  const chips = [];\n  const msg = assistantMsg?.text?.assistant_message || assistantMsg?.text || \"\";\n\n  if (/metric/i.test(msg)) chips.push(\"TRx\", \"NBRx\");\n  if (/brand|product/i.test(msg)) chips.push(\"Exelon\", \"Risperidone\");\n  if (/geo|region|territory|ecosystem/i.test(msg)) chips.push(\"Region\", \"Territory\");\n  if (/time period|period|week|month|ytd/i.test(msg)) chips.push(\"CW\", \"R4W\", \"YTD\");\n  if (/channel/i.test(msg)) chips.push(\"Retail\", \"LTC\");\n  if (/age group/i.test(msg)) chips.push(\"18-64\", \"65+\");\n  // Remove duplicates\n  return [...new Set(chips)];\n}\n\n// Helper to check if assistant message is a clarifying message (bullets or numbered list)\nfunction isClarification(msg) {\n  // Check if text has multiple lines starting with - or numbers or a question mark.\n  const txt = msg.text?.assistant_message || msg.text || \"\";\n  const bulletLines = txt.split('\\n').filter(line =>\n    line.trim().match(/^(\\d+\\.|-)\\s+/)\n  );\n  return bulletLines.length > 0;\n}\n\n// ----------- DOWNLOAD HELPER ----------------\nfunction getMessageText(msg) {\n  if (typeof msg.text === \"string\") return msg.text;\n  if (msg.text && typeof msg.text === \"object\" && \"value\" in msg.text)\n    return msg.text.value ?? JSON.stringify(msg.text);\n  if (msg.text != null) return JSON.stringify(msg.text);\n  return \"\";\n}\n\nfunction downloadChat(messages) {\n  const header = \"Field Insights Assistant - Chat Conversation\\n\\n\";\n  const chatText = messages.map(\n    (msg) => `${msg.role === \"user\" ? \"User\" : \"Assistant\"}: ${getMessageText(msg)}`\n  ).join('\\n\\n');\n  const content = header + chatText;\n  const blob = new Blob([content], { type: \"text/plain\" });\n  const link = document.createElement(\"a\");\n  link.href = URL.createObjectURL(blob);\n  link.download = `chat-session-${new Date().toISOString().slice(0,19).replace(/:/g,\"-\")}.txt`;\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n}\n\n// ----------- MAIN COMPONENT ----------------\nconst ChatBot = () => {\n  const [messages, setMessages] = useState(() => {\n    const saved = localStorage.getItem('chatMessages');\n    if (saved) return JSON.parse(saved);\n    return [{ role: 'assistant', text: 'Hello üëã! How may I assist you?' }];\n  });\n\n  const [feedback, setFeedback] = useState({});\n  const [input, setInput] = useState('');\n  const [isOpen, setIsOpen] = useState(false);\n  const [darkMode, setDarkMode] = useState(false);\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [toast, setToast] = useState({ message: '', type: 'info', visible: false });\n  const [isTyping, setIsTyping] = useState(false);\n\n  const chatRef = useRef();\n  const inputRef = useRef();\n\n  useEffect(() => {\n    chatRef.current?.scrollTo({ top: chatRef.current.scrollHeight, behavior: 'smooth' });\n  }, [messages, isTyping, isOpen, isExpanded]);\n\n  useEffect(() => {\n    if (inputRef.current) {\n      inputRef.current.scrollLeft = inputRef.current.value.length * 8;\n    }\n  }, [input]);\n\n  useEffect(() => {\n    if (toast.visible) {\n      const timer = setTimeout(() => {\n        setToast(t => ({ ...t, visible: false }));\n      }, 1500);\n      return () => clearTimeout(timer);\n    }\n  }, [toast.visible]);\n\n  const showToast = (msg, type) => {\n    setToast({ message: msg, type: type, visible: true });\n  };\n\n  // ----------- MAIN LOGIC ----------------\n  const handleSendMessage = async (userMessage) => {\n    if (!userMessage || typeof userMessage !== \"string\" || !userMessage.trim()) return;\n    setInput('');\n    setIsTyping(true);\n\n    // HARDCODED ANSWERS (instant, no LLM)\n    const cleaned = userMessage.trim().toLowerCase();\n    const matchedKey = Object.keys(HARDCODED_ANSWERS).find(k => cleaned.includes(k));\n    if (matchedKey) {\n      setIsTyping(false);\n      const updatedMessages = [...messages, { role: 'user', text: userMessage }, { role: 'assistant', text: HARDCODED_ANSWERS[matchedKey] }];\n      setMessages(updatedMessages);\n      localStorage.setItem('chatMessages', JSON.stringify(updatedMessages));\n      return;\n    }\n\n    // Always send message to clarify endpoint\n    const updatedMessages = [...messages, { role: 'user', text: userMessage }];\n    setMessages(updatedMessages);\n\n    try {\n      const response = await fetch('http://localhost:4000/api/clarify', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ userMessage })\n      });\n      const { assistant_message, finalized } = await response.json();\n\n      if (finalized) {\n        // Show the final OpenAI prompt as a user message (right side)\n        setMessages(prev => [...prev, { role: 'user', text: assistant_message }]);\n        setIsTyping(true);\n\n        let finalPrompt = assistant_message;\n        if (typeof finalPrompt === \"string\" && /^[\"‚Äú‚Äù'].*[\"‚Äú‚Äù']$/.test(finalPrompt.trim())) {\n          finalPrompt = finalPrompt.trim().replace(/^[\"‚Äú‚Äù']|[\"‚Äú‚Äù']$/g, \"\");\n        }\n\n        let body = { statement: `CALL CUSTOM_AGENT2('${finalPrompt.replace(/'/g, \"''\")}')` };\n        const snowflakeRes = await fetch('http://localhost:4000/api/snowflake', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(body)\n        });\n        const responseText = await snowflakeRes.text();\n\n        setIsTyping(false);\n\n        // Only show \"output\" from response\n        const formatted = formatSnowflakeResponse(responseText);\n        setMessages(prev => [\n          ...prev,\n          { role: \"assistant\", text: formatted.value || \"No response.\" }\n        ]);\n        return;\n      } else {\n        setIsTyping(false);\n        setMessages(prev => [...prev, { role: 'assistant', text: assistant_message }]);\n        return;\n      }\n    } catch (error) {\n      setIsTyping(false);\n      setMessages(prev => [...prev, { role: 'assistant', text: \"Sorry, I couldn't process your query. Please try again.\" }]);\n      return;\n    }\n  };\n\n  const handleFeedback = (idx, type) => {\n    setFeedback(prev => ({ ...prev, [idx]: type }));\n    showToast(type === \"up\" ? \"Marked as helpful!\" : \"Marked as not helpful!\", type === \"up\" ? \"success\" : \"error\");\n  };\n\n  const toggleTheme = () => setDarkMode(prev => !prev);\n\n  const renderChatBubbleContent = (msg) => {\n    if (typeof msg.text === \"object\" && msg.text !== null) {\n      if (msg.text.type === \"output\") return <div>{msg.text.value}</div>;\n      if (msg.text.type === \"error\") return <span style={{ color: \"#b91c1c\", fontWeight: 500 }}>{msg.text.value}</span>;\n      return <pre>{JSON.stringify(msg.text.value, null, 2)}</pre>;\n    }\n    return (msg.text || \"\").split('\\n').map((line, i) => (\n      <div key={i}>{line}</div>\n    ));\n  };\n\n  // ----------- CHIPS RENDER FUNCTION ----------------\n  const renderQuickReplies = (msg, idx) => {\n    // Only for clarification steps, don't show chips for final outputs\n    if (msg.role !== 'assistant' || !isClarification(msg)) return null;\n    const chips = getSuggestedChips(msg);\n    if (chips.length === 0) return null;\n    return (\n      <div className=\"chip-row\">\n        {chips.map(chip => (\n          <button\n            key={chip}\n            className=\"suggestion-chip\"\n            onClick={() => handleSendMessage(chip)}\n          >\n            {chip}\n          </button>\n        ))}\n      </div>\n    );\n  };\n\n  return (\n    <div style={{ background: 'linear-gradient(to bottom right, #f7faff, #e2ecf4)', minHeight: '100vh' }}>\n      <button\n        className=\"chatbot-toggler modern-toggler\"\n        onClick={() => setIsOpen(!isOpen)}\n        aria-label=\"Toggle chatbot\"\n        style={{ position: 'fixed', right: '20px', bottom: '20px', zIndex: 10000 }}>\n        {isOpen ? '‚úñ' : <img src={ChatbotIcon} alt=\"Chatbot\" style={{ width: 48, height: 48 }} />}\n      </button>\n      {isOpen && (\n        <div\n          className={\n            `chatbot modern-chatbot` +\n            (darkMode ? ' dark-mode' : '') +\n            (isExpanded ? ' expanded' : ' collapsed')\n          }\n        >\n          <header className=\"chatbot-header\">\n            <span className=\"header-title\">\n              Field Insights<span className=\"header-title-gradient\"> Assistant</span>\n            </span>\n            <div className=\"header-controls\">\n              <div className=\"header-actions\">\n                <button onClick={toggleTheme} title=\"Toggle theme\" className=\"header-action-btn\" aria-label=\"Toggle theme\">\n                  {darkMode ? (\n                    <svg width=\"25\" height=\"25\" viewBox=\"0 0 24 24\" fill=\"none\">\n                      <circle cx=\"12\" cy=\"12\" r=\"5\" fill=\"#7c3aed\" />\n                      <g stroke=\"#7c3aed\" strokeWidth=\"2\">\n                        <line x1=\"12\" y1=\"2\" x2=\"12\" y2=\"5\" />\n                        <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"22\" />\n                        <line x1=\"4.22\" y1=\"4.22\" x2=\"6.34\" y2=\"6.34\" />\n                        <line x1=\"17.66\" y1=\"17.66\" x2=\"19.78\" y2=\"19.78\" />\n                        <line x1=\"2\" y1=\"12\" x2=\"5\" y2=\"12\" />\n                        <line x1=\"19\" y1=\"12\" x2=\"22\" y2=\"12\" />\n                        <line x1=\"4.22\" y1=\"19.78\" x2=\"6.34\" y2=\"17.66\" />\n                        <line x1=\"17.66\" y1=\"6.34\" x2=\"19.78\" y2=\"4.22\" />\n                      </g>\n                    </svg>\n                  ) : (\n                    <svg width=\"25\" height=\"25\" viewBox=\"0 0 24 24\" fill=\"none\">\n                      <path d=\"M21 12.79A9 9 0 1111.21 3a7 7 0 0010.02 9.79z\" fill=\"#7c3aed\" />\n                    </svg>\n                  )}\n                </button>\n                <button\n                  onClick={() => {\n                    setMessages([{ role: 'assistant', text: 'Hello üëã! How may I assist you?' }]);\n                    localStorage.removeItem('chatMessages');\n                    setFeedback({});\n                  }}\n                  title=\"Clear chat\"\n                  className=\"header-action-btn\"\n                  aria-label=\"Clear chat\"\n                >\n                  <svg width=\"25\" height=\"25\" fill=\"none\" stroke=\"#7c3aed\" strokeWidth=\"2.1\" viewBox=\"0 0 24 24\">\n                    <path d=\"M4.93 4.93a10 10 0 1014.14 0M23 4v6h-6\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n                  </svg>\n                </button>\n                <button\n                  onClick={() => setIsExpanded((prev) => !prev)}\n                  title={isExpanded ? 'Collapse window' : 'Expand window'}\n                  className=\"header-action-btn\"\n                  aria-label={isExpanded ? 'Collapse window' : 'Expand window'}\n                >\n                  {isExpanded ? (\n                    <svg width=\"25\" height=\"25\" fill=\"none\" stroke=\"#7c3aed\" strokeWidth=\"2.1\" viewBox=\"0 0 24 24\">\n                      <polyline points=\"8 3 3 3 3 8\" />\n                      <line x1=\"3\" y1=\"3\" x2=\"10\" y2=\"10\" />\n                      <polyline points=\"16 21 21 21 21 16\" />\n                      <line x1=\"21\" y1=\"21\" x2=\"14\" y2=\"14\" />\n                    </svg>\n                  ) : (\n                    <svg width=\"25\" height=\"25\" fill=\"none\" stroke=\"#7c3aed\" strokeWidth=\"2.1\" viewBox=\"0 0 24 24\">\n                      <polyline points=\"15 3 21 3 21 9\" />\n                      <line x1=\"21\" y1=\"3\" x2=\"14\" y2=\"10\" />\n                      <polyline points=\"9 21 3 21 3 15\" />\n                      <line x1=\"3\" y1=\"21\" x2=\"10\" y2=\"14\" />\n                    </svg>\n                  )}\n                </button>\n              </div>\n            </div>\n          </header>\n          <ul className=\"chatbox\" ref={chatRef}>\n            {messages.map((msg, idx) => (\n              <li\n                key={idx}\n                className={`chat ${msg.role === 'user' ? 'outgoing' : 'incoming'}`}\n                style={{ justifyContent: msg.role === 'user' ? 'flex-end' : 'flex-start' }}\n              >\n                <div className={`chat-bubble ${msg.role}`}>\n                  {renderChatBubbleContent(msg)}\n                </div>\n                {/* Feedback row */}\n                {msg.role === 'assistant' && (\n                  <div className=\"feedback-row\">\n                    {feedback[idx] === undefined && (\n                      <>\n                        <Tooltip text=\"Mark as helpful\">\n                          <button\n                            className=\"feedback-btn\"\n                            onClick={() => handleFeedback(idx, 'up')}\n                            aria-label=\"Thumbs up\"\n                            tabIndex={0}\n                          >üëç</button>\n                        </Tooltip>\n                        <Tooltip text=\"Mark as not helpful\">\n                          <button\n                            className=\"feedback-btn\"\n                            onClick={() => handleFeedback(idx, 'down')}\n                            aria-label=\"Thumbs down\"\n                            tabIndex={0}\n                          >üëé</button>\n                        </Tooltip>\n                      </>\n                    )}\n                    {feedback[idx] === 'up' && (\n                      <Tooltip text=\"Marked as helpful!\">\n                        <button className=\"feedback-btn selected up\" aria-label=\"Thumbs up\" tabIndex={0}>üëç</button>\n                      </Tooltip>\n                    )}\n                    {feedback[idx] === 'down' && (\n                      <Tooltip text=\"Marked as not helpful\">\n                        <button className=\"feedback-btn selected down\" aria-label=\"Thumbs down\" tabIndex={0}>üëé</button>\n                      </Tooltip>\n                    )}\n                  </div>\n                )}\n                {/* Contextual Quick Replies */}\n                {renderQuickReplies(msg, idx)}\n              </li>\n            ))}\n            {isTyping && (\n              <li className=\"chat incoming\">\n                <div className=\"chat-bubble assistant\">\n                  <TypingIndicator />\n                </div>\n              </li>\n            )}\n          </ul>\n          <div className=\"chat-input\">\n            <textarea\n              ref={inputRef}\n              placeholder=\"Ask me anything...\"\n              value={input}\n              onChange={e => setInput(e.target.value)}\n              onKeyDown={e => {\n                if (e.key === 'Enter' && !e.shiftKey) {\n                  e.preventDefault();\n                  handleSendMessage(input);\n                }\n              }}\n              rows={1}\n              className=\"chat-input-textarea\"\n              style={{ overflow: 'hidden', resize: 'none' }}\n              disabled={isTyping}\n              autoFocus={isOpen}\n              aria-label=\"Type your message\"\n            />\n            <button\n              onClick={() => handleSendMessage(input)}\n              title=\"Send message\"\n              className={`send-button${input.trim() ? \" has-text\" : \"\"}`}\n              disabled={isTyping || !input.trim()}\n              aria-label=\"Send\"\n            >\n              <svg height=\"22\" width=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" style={{ display: \"block\" }}>\n                <path d=\"M4 20L20 12L4 4V10L16 12L4 14V20Z\" fill=\"currentColor\" />\n              </svg>\n            </button>\n          </div>\n<footer\n  className=\"chatbot-footer\"\n  style={{\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    position: \"relative\",\n    width: \"100%\",\n    minHeight: \"40px\",\n    padding: \"8px 0\",\n  }}\n>\n  {/* Download button absolutely positioned at left */}\n  <button\n    onClick={() => downloadChat(messages)}\n    title=\"Download conversation\"\n    className=\"header-action-btn\"\n    aria-label=\"Download chat\"\n    style={{\n      position: \"absolute\",\n      left: 0,\n      top: \"45%\",\n      transform: \"translateY(-50%)\",\n      background: \"none\",\n      border: \"none\",\n      cursor: \"pointer\",\n      padding: \"0 0 0 12px\",\n      height: \"100%\",\n      display: \"flex\",\n      alignItems: \"center\"\n    }}\n  >\n    <svg width=\"22\" height=\"22\" fill=\"none\" viewBox=\"0 0 24 24\">\n      <path d=\"M12 16v-8M12 16l-4-4M12 16l4-4M4 20h16\" stroke=\"#7c3aed\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n    </svg>\n  </button>\n  {/* Centered powered by ZS */}\n  <span style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"center\" }}>\n    Powered by <img src={ZSIcon} alt=\"ZS Associates\" style={{ marginLeft: 5, height: 25 }} />\n  </span>\n</footer>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ChatBot;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AAC1D,OAAO,qBAAqB;AAC5B,OAAOC,WAAW,MAAM,+BAA+B;AACvD,OAAOC,MAAM,MAAM,6BAA6B;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAEjD,MAAMC,iBAAiB,GAAG;EACxB,sDAAsD,EAAE,oEAAoE;EAC5H,2BAA2B,EAAE,8GAA8G;EAC3I,wDAAwD,EAAE,0EAA0E;EACpI,2DAA2D,EAAE,kFAAkF;EAC/I,qDAAqD,EAAE,0FAA0F;EACjJ,oBAAoB,EAAE,iNAAiN;EACvO,qDAAqD,EAAE,gHAAgH;EACvK,6CAA6C,EAAE;AACjD,CAAC;AAED,SAASC,uBAAuBA,CAACC,YAAY,EAAE;EAC7C,IAAI;IACF,IAAIC,IAAI,GAAG,OAAOD,YAAY,KAAK,QAAQ,GAAGE,IAAI,CAACC,KAAK,CAACH,YAAY,CAAC,GAAGA,YAAY;IACrF,IACEI,KAAK,CAACC,OAAO,CAACJ,IAAI,CAACK,IAAI,CAAC,IACxBL,IAAI,CAACK,IAAI,CAACC,MAAM,GAAG,CAAC,IACpBH,KAAK,CAACC,OAAO,CAACJ,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC,CAAC,IAC3B,OAAOL,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,QAAQ,IACnCL,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACE,IAAI,CAAC,CAAC,CAACC,UAAU,CAAC,GAAG,CAAC,EACtC;MACA,MAAMC,KAAK,GAAGR,IAAI,CAACC,KAAK,CAACF,IAAI,CAACK,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACzC,IAAII,KAAK,CAACC,MAAM,EAAE,OAAO;QAAEC,IAAI,EAAE,QAAQ;QAAEC,KAAK,EAAEH,KAAK,CAACC;MAAO,CAAC;MAChE,OAAO;QAAEC,IAAI,EAAE,QAAQ;QAAEC,KAAK,EAAEX,IAAI,CAACY,SAAS,CAACJ,KAAK,EAAE,IAAI,EAAE,CAAC;MAAE,CAAC;IAClE;IACA,IAAIT,IAAI,CAACU,MAAM,EAAE,OAAO;MAAEC,IAAI,EAAE,QAAQ;MAAEC,KAAK,EAAEZ,IAAI,CAACU;IAAO,CAAC;IAC9D,IAAIV,IAAI,CAACc,KAAK,EAAE,OAAO;MAAEH,IAAI,EAAE,OAAO;MAAEC,KAAK,EAAE,WAAW,GAAGZ,IAAI,CAACc;IAAM,CAAC;IACzE,IACEd,IAAI,CAACe,IAAI,IACTf,IAAI,CAACe,IAAI,KAAK,QAAQ,KACrB,CAACf,IAAI,CAACgB,OAAO,IAAI,CAAChB,IAAI,CAACgB,OAAO,CAACC,WAAW,CAAC,CAAC,CAACC,QAAQ,CAAC,uBAAuB,CAAC,CAAC,EAChF;MACA,OAAO;QAAEP,IAAI,EAAE,OAAO;QAAEC,KAAK,EAAE,YAAYZ,IAAI,CAACe,IAAI,MAAMf,IAAI,CAACgB,OAAO;MAAG,CAAC;IAC5E;IACA,IAAIhB,IAAI,CAACgB,OAAO,EAAE,OAAO;MAAEL,IAAI,EAAE,QAAQ;MAAEC,KAAK,EAAEZ,IAAI,CAACgB;IAAQ,CAAC;IAChE,OAAO;MAAEL,IAAI,EAAE,QAAQ;MAAEC,KAAK,EAAE;IAAiB,CAAC;EACpD,CAAC,CAAC,MAAM;IACN,OAAO;MAAED,IAAI,EAAE,OAAO;MAAEC,KAAK,EAAEb,YAAY,IAAI;IAA4B,CAAC;EAC9E;AACF;AAEA,SAASoB,eAAeA,CAAA,EAAG;EACzB,oBACEzB,OAAA;IAAM0B,SAAS,EAAC,kBAAkB;IAAAC,QAAA,gBAChC3B,OAAA;MAAA4B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAY,CAAC,eAAA/B,OAAA;MAAA4B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAY,CAAC,eAAA/B,OAAA;MAAA4B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAY,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACnC,CAAC;AAEX;AAACC,EAAA,GANQP,eAAe;AAQxB,MAAMQ,OAAO,GAAGA,CAAC;EAAEN,QAAQ;EAAEO;AAAK,CAAC,kBACjClC,OAAA;EAAM0B,SAAS,EAAC,kBAAkB;EAAAC,QAAA,GAC/BA,QAAQ,eACT3B,OAAA;IAAM0B,SAAS,EAAC,sBAAsB;IAAAC,QAAA,EAAEO;EAAI;IAAAN,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAO,CAAC;AAAA;EAAAH,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,OAChD,CACP;;AAED;AAAAI,GAAA,GAPMF,OAAO;AAQb,SAASG,iBAAiBA,CAACC,YAAY,EAAE;EAAA,IAAAC,kBAAA;EACvC;EACA,MAAMC,KAAK,GAAG,EAAE;EAChB,MAAMC,GAAG,GAAG,CAAAH,YAAY,aAAZA,YAAY,wBAAAC,kBAAA,GAAZD,YAAY,CAAEH,IAAI,cAAAI,kBAAA,uBAAlBA,kBAAA,CAAoBG,iBAAiB,MAAIJ,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAEH,IAAI,KAAI,EAAE;EAE7E,IAAI,SAAS,CAACQ,IAAI,CAACF,GAAG,CAAC,EAAED,KAAK,CAACI,IAAI,CAAC,KAAK,EAAE,MAAM,CAAC;EAClD,IAAI,gBAAgB,CAACD,IAAI,CAACF,GAAG,CAAC,EAAED,KAAK,CAACI,IAAI,CAAC,QAAQ,EAAE,aAAa,CAAC;EACnE,IAAI,iCAAiC,CAACD,IAAI,CAACF,GAAG,CAAC,EAAED,KAAK,CAACI,IAAI,CAAC,QAAQ,EAAE,WAAW,CAAC;EAClF,IAAI,oCAAoC,CAACD,IAAI,CAACF,GAAG,CAAC,EAAED,KAAK,CAACI,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,KAAK,CAAC;EAClF,IAAI,UAAU,CAACD,IAAI,CAACF,GAAG,CAAC,EAAED,KAAK,CAACI,IAAI,CAAC,QAAQ,EAAE,KAAK,CAAC;EACrD,IAAI,YAAY,CAACD,IAAI,CAACF,GAAG,CAAC,EAAED,KAAK,CAACI,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC;EACtD;EACA,OAAO,CAAC,GAAG,IAAIC,GAAG,CAACL,KAAK,CAAC,CAAC;AAC5B;;AAEA;AACA,SAASM,eAAeA,CAACL,GAAG,EAAE;EAAA,IAAAM,SAAA;EAC5B;EACA,MAAMC,GAAG,GAAG,EAAAD,SAAA,GAAAN,GAAG,CAACN,IAAI,cAAAY,SAAA,uBAARA,SAAA,CAAUL,iBAAiB,KAAID,GAAG,CAACN,IAAI,IAAI,EAAE;EACzD,MAAMc,WAAW,GAAGD,GAAG,CAACE,KAAK,CAAC,IAAI,CAAC,CAACC,MAAM,CAACC,IAAI,IAC7CA,IAAI,CAACtC,IAAI,CAAC,CAAC,CAACuC,KAAK,CAAC,eAAe,CACnC,CAAC;EACD,OAAOJ,WAAW,CAACpC,MAAM,GAAG,CAAC;AAC/B;;AAEA;AACA,SAASyC,cAAcA,CAACb,GAAG,EAAE;EAAA,IAAAc,eAAA;EAC3B,IAAI,OAAOd,GAAG,CAACN,IAAI,KAAK,QAAQ,EAAE,OAAOM,GAAG,CAACN,IAAI;EACjD,IAAIM,GAAG,CAACN,IAAI,IAAI,OAAOM,GAAG,CAACN,IAAI,KAAK,QAAQ,IAAI,OAAO,IAAIM,GAAG,CAACN,IAAI,EACjE,QAAAoB,eAAA,GAAOd,GAAG,CAACN,IAAI,CAAChB,KAAK,cAAAoC,eAAA,cAAAA,eAAA,GAAI/C,IAAI,CAACY,SAAS,CAACqB,GAAG,CAACN,IAAI,CAAC;EACnD,IAAIM,GAAG,CAACN,IAAI,IAAI,IAAI,EAAE,OAAO3B,IAAI,CAACY,SAAS,CAACqB,GAAG,CAACN,IAAI,CAAC;EACrD,OAAO,EAAE;AACX;AAEA,SAASqB,YAAYA,CAACC,QAAQ,EAAE;EAC9B,MAAMC,MAAM,GAAG,kDAAkD;EACjE,MAAMC,QAAQ,GAAGF,QAAQ,CAACG,GAAG,CAC1BnB,GAAG,IAAK,GAAGA,GAAG,CAACoB,IAAI,KAAK,MAAM,GAAG,MAAM,GAAG,WAAW,KAAKP,cAAc,CAACb,GAAG,CAAC,EAChF,CAAC,CAACqB,IAAI,CAAC,MAAM,CAAC;EACd,MAAMC,OAAO,GAAGL,MAAM,GAAGC,QAAQ;EACjC,MAAMK,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACF,OAAO,CAAC,EAAE;IAAE7C,IAAI,EAAE;EAAa,CAAC,CAAC;EACxD,MAAMgD,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;EACxCF,IAAI,CAACG,IAAI,GAAGC,GAAG,CAACC,eAAe,CAACP,IAAI,CAAC;EACrCE,IAAI,CAACM,QAAQ,GAAG,gBAAgB,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,EAAC,EAAE,CAAC,CAACC,OAAO,CAAC,IAAI,EAAC,GAAG,CAAC,MAAM;EAC5FT,QAAQ,CAACU,IAAI,CAACC,WAAW,CAACZ,IAAI,CAAC;EAC/BA,IAAI,CAACa,KAAK,CAAC,CAAC;EACZZ,QAAQ,CAACU,IAAI,CAACG,WAAW,CAACd,IAAI,CAAC;AACjC;;AAEA;AACA,MAAMe,OAAO,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACpB,MAAM,CAACzB,QAAQ,EAAE0B,WAAW,CAAC,GAAGtF,QAAQ,CAAC,MAAM;IAC7C,MAAMuF,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;IAClD,IAAIF,KAAK,EAAE,OAAO5E,IAAI,CAACC,KAAK,CAAC2E,KAAK,CAAC;IACnC,OAAO,CAAC;MAAEvB,IAAI,EAAE,WAAW;MAAE1B,IAAI,EAAE;IAAkC,CAAC,CAAC;EACzE,CAAC,CAAC;EAEF,MAAM,CAACoD,QAAQ,EAAEC,WAAW,CAAC,GAAG3F,QAAQ,CAAC,CAAC,CAAC,CAAC;EAC5C,MAAM,CAAC4F,KAAK,EAAEC,QAAQ,CAAC,GAAG7F,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAAC8F,MAAM,EAAEC,SAAS,CAAC,GAAG/F,QAAQ,CAAC,KAAK,CAAC;EAC3C,MAAM,CAACgG,QAAQ,EAAEC,WAAW,CAAC,GAAGjG,QAAQ,CAAC,KAAK,CAAC;EAC/C,MAAM,CAACkG,UAAU,EAAEC,aAAa,CAAC,GAAGnG,QAAQ,CAAC,KAAK,CAAC;EACnD,MAAM,CAACoG,KAAK,EAAEC,QAAQ,CAAC,GAAGrG,QAAQ,CAAC;IAAE0B,OAAO,EAAE,EAAE;IAAEL,IAAI,EAAE,MAAM;IAAEiF,OAAO,EAAE;EAAM,CAAC,CAAC;EACjF,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGxG,QAAQ,CAAC,KAAK,CAAC;EAE/C,MAAMyG,OAAO,GAAG1G,MAAM,CAAC,CAAC;EACxB,MAAM2G,QAAQ,GAAG3G,MAAM,CAAC,CAAC;EAEzBD,SAAS,CAAC,MAAM;IAAA,IAAA6G,gBAAA;IACd,CAAAA,gBAAA,GAAAF,OAAO,CAACG,OAAO,cAAAD,gBAAA,uBAAfA,gBAAA,CAAiBE,QAAQ,CAAC;MAAEC,GAAG,EAAEL,OAAO,CAACG,OAAO,CAACG,YAAY;MAAEC,QAAQ,EAAE;IAAS,CAAC,CAAC;EACtF,CAAC,EAAE,CAACpD,QAAQ,EAAE2C,QAAQ,EAAET,MAAM,EAAEI,UAAU,CAAC,CAAC;EAE5CpG,SAAS,CAAC,MAAM;IACd,IAAI4G,QAAQ,CAACE,OAAO,EAAE;MACpBF,QAAQ,CAACE,OAAO,CAACK,UAAU,GAAGP,QAAQ,CAACE,OAAO,CAACtF,KAAK,CAACN,MAAM,GAAG,CAAC;IACjE;EACF,CAAC,EAAE,CAAC4E,KAAK,CAAC,CAAC;EAEX9F,SAAS,CAAC,MAAM;IACd,IAAIsG,KAAK,CAACE,OAAO,EAAE;MACjB,MAAMY,KAAK,GAAGC,UAAU,CAAC,MAAM;QAC7Bd,QAAQ,CAACe,CAAC,KAAK;UAAE,GAAGA,CAAC;UAAEd,OAAO,EAAE;QAAM,CAAC,CAAC,CAAC;MAC3C,CAAC,EAAE,IAAI,CAAC;MACR,OAAO,MAAMe,YAAY,CAACH,KAAK,CAAC;IAClC;EACF,CAAC,EAAE,CAACd,KAAK,CAACE,OAAO,CAAC,CAAC;EAEnB,MAAMgB,SAAS,GAAGA,CAAC1E,GAAG,EAAEvB,IAAI,KAAK;IAC/BgF,QAAQ,CAAC;MAAE3E,OAAO,EAAEkB,GAAG;MAAEvB,IAAI,EAAEA,IAAI;MAAEiF,OAAO,EAAE;IAAK,CAAC,CAAC;EACvD,CAAC;;EAED;EACA,MAAMiB,iBAAiB,GAAG,MAAOC,WAAW,IAAK;IAC/C,IAAI,CAACA,WAAW,IAAI,OAAOA,WAAW,KAAK,QAAQ,IAAI,CAACA,WAAW,CAACvG,IAAI,CAAC,CAAC,EAAE;IAC5E4E,QAAQ,CAAC,EAAE,CAAC;IACZW,WAAW,CAAC,IAAI,CAAC;;IAEjB;IACA,MAAMiB,OAAO,GAAGD,WAAW,CAACvG,IAAI,CAAC,CAAC,CAACU,WAAW,CAAC,CAAC;IAChD,MAAM+F,UAAU,GAAGC,MAAM,CAACC,IAAI,CAACrH,iBAAiB,CAAC,CAACsH,IAAI,CAACC,CAAC,IAAIL,OAAO,CAAC7F,QAAQ,CAACkG,CAAC,CAAC,CAAC;IAChF,IAAIJ,UAAU,EAAE;MACdlB,WAAW,CAAC,KAAK,CAAC;MAClB,MAAMuB,eAAe,GAAG,CAAC,GAAGnE,QAAQ,EAAE;QAAEI,IAAI,EAAE,MAAM;QAAE1B,IAAI,EAAEkF;MAAY,CAAC,EAAE;QAAExD,IAAI,EAAE,WAAW;QAAE1B,IAAI,EAAE/B,iBAAiB,CAACmH,UAAU;MAAE,CAAC,CAAC;MACtIpC,WAAW,CAACyC,eAAe,CAAC;MAC5BvC,YAAY,CAACwC,OAAO,CAAC,cAAc,EAAErH,IAAI,CAACY,SAAS,CAACwG,eAAe,CAAC,CAAC;MACrE;IACF;;IAEA;IACA,MAAMA,eAAe,GAAG,CAAC,GAAGnE,QAAQ,EAAE;MAAEI,IAAI,EAAE,MAAM;MAAE1B,IAAI,EAAEkF;IAAY,CAAC,CAAC;IAC1ElC,WAAW,CAACyC,eAAe,CAAC;IAE5B,IAAI;MACF,MAAME,QAAQ,GAAG,MAAMC,KAAK,CAAC,mCAAmC,EAAE;QAChEC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAC/CpD,IAAI,EAAErE,IAAI,CAACY,SAAS,CAAC;UAAEiG;QAAY,CAAC;MACtC,CAAC,CAAC;MACF,MAAM;QAAE3E,iBAAiB;QAAEwF;MAAU,CAAC,GAAG,MAAMJ,QAAQ,CAACvH,IAAI,CAAC,CAAC;MAE9D,IAAI2H,SAAS,EAAE;QACb;QACA/C,WAAW,CAACgD,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAE;UAAEtE,IAAI,EAAE,MAAM;UAAE1B,IAAI,EAAEO;QAAkB,CAAC,CAAC,CAAC;QACzE2D,WAAW,CAAC,IAAI,CAAC;QAEjB,IAAI+B,WAAW,GAAG1F,iBAAiB;QACnC,IAAI,OAAO0F,WAAW,KAAK,QAAQ,IAAI,kBAAkB,CAACzF,IAAI,CAACyF,WAAW,CAACtH,IAAI,CAAC,CAAC,CAAC,EAAE;UAClFsH,WAAW,GAAGA,WAAW,CAACtH,IAAI,CAAC,CAAC,CAAC8D,OAAO,CAAC,kBAAkB,EAAE,EAAE,CAAC;QAClE;QAEA,IAAIC,IAAI,GAAG;UAAEwD,SAAS,EAAE,uBAAuBD,WAAW,CAACxD,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC;QAAK,CAAC;QACpF,MAAM0D,YAAY,GAAG,MAAMP,KAAK,CAAC,qCAAqC,EAAE;UACtEC,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YAAE,cAAc,EAAE;UAAmB,CAAC;UAC/CpD,IAAI,EAAErE,IAAI,CAACY,SAAS,CAACyD,IAAI;QAC3B,CAAC,CAAC;QACF,MAAMvE,YAAY,GAAG,MAAMgI,YAAY,CAACnG,IAAI,CAAC,CAAC;QAE9CkE,WAAW,CAAC,KAAK,CAAC;;QAElB;QACA,MAAMkC,SAAS,GAAGlI,uBAAuB,CAACC,YAAY,CAAC;QACvD6E,WAAW,CAACgD,IAAI,IAAI,CAClB,GAAGA,IAAI,EACP;UAAEtE,IAAI,EAAE,WAAW;UAAE1B,IAAI,EAAEoG,SAAS,CAACpH,KAAK,IAAI;QAAe,CAAC,CAC/D,CAAC;QACF;MACF,CAAC,MAAM;QACLkF,WAAW,CAAC,KAAK,CAAC;QAClBlB,WAAW,CAACgD,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAE;UAAEtE,IAAI,EAAE,WAAW;UAAE1B,IAAI,EAAEO;QAAkB,CAAC,CAAC,CAAC;QAC9E;MACF;IACF,CAAC,CAAC,OAAOrB,KAAK,EAAE;MACdgF,WAAW,CAAC,KAAK,CAAC;MAClBlB,WAAW,CAACgD,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAE;QAAEtE,IAAI,EAAE,WAAW;QAAE1B,IAAI,EAAE;MAA0D,CAAC,CAAC,CAAC;MACtH;IACF;EACF,CAAC;EAED,MAAMqG,cAAc,GAAGA,CAACC,GAAG,EAAEvH,IAAI,KAAK;IACpCsE,WAAW,CAAC2C,IAAI,KAAK;MAAE,GAAGA,IAAI;MAAE,CAACM,GAAG,GAAGvH;IAAK,CAAC,CAAC,CAAC;IAC/CiG,SAAS,CAACjG,IAAI,KAAK,IAAI,GAAG,oBAAoB,GAAG,wBAAwB,EAAEA,IAAI,KAAK,IAAI,GAAG,SAAS,GAAG,OAAO,CAAC;EACjH,CAAC;EAED,MAAMwH,WAAW,GAAGA,CAAA,KAAM5C,WAAW,CAACqC,IAAI,IAAI,CAACA,IAAI,CAAC;EAEpD,MAAMQ,uBAAuB,GAAIlG,GAAG,IAAK;IACvC,IAAI,OAAOA,GAAG,CAACN,IAAI,KAAK,QAAQ,IAAIM,GAAG,CAACN,IAAI,KAAK,IAAI,EAAE;MACrD,IAAIM,GAAG,CAACN,IAAI,CAACjB,IAAI,KAAK,QAAQ,EAAE,oBAAOjB,OAAA;QAAA2B,QAAA,EAAMa,GAAG,CAACN,IAAI,CAAChB;MAAK;QAAAU,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC;MAClE,IAAIS,GAAG,CAACN,IAAI,CAACjB,IAAI,KAAK,OAAO,EAAE,oBAAOjB,OAAA;QAAM2I,KAAK,EAAE;UAAEC,KAAK,EAAE,SAAS;UAAEC,UAAU,EAAE;QAAI,CAAE;QAAAlH,QAAA,EAAEa,GAAG,CAACN,IAAI,CAAChB;MAAK;QAAAU,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC;MACjH,oBAAO/B,OAAA;QAAA2B,QAAA,EAAMpB,IAAI,CAACY,SAAS,CAACqB,GAAG,CAACN,IAAI,CAAChB,KAAK,EAAE,IAAI,EAAE,CAAC;MAAC;QAAAU,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC;IAC7D;IACA,OAAO,CAACS,GAAG,CAACN,IAAI,IAAI,EAAE,EAAEe,KAAK,CAAC,IAAI,CAAC,CAACU,GAAG,CAAC,CAACR,IAAI,EAAE2F,CAAC,kBAC9C9I,OAAA;MAAA2B,QAAA,EAAcwB;IAAI,GAAR2F,CAAC;MAAAlH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAa,CACzB,CAAC;EACJ,CAAC;;EAED;EACA,MAAMgH,kBAAkB,GAAGA,CAACvG,GAAG,EAAEgG,GAAG,KAAK;IACvC;IACA,IAAIhG,GAAG,CAACoB,IAAI,KAAK,WAAW,IAAI,CAACf,eAAe,CAACL,GAAG,CAAC,EAAE,OAAO,IAAI;IAClE,MAAMD,KAAK,GAAGH,iBAAiB,CAACI,GAAG,CAAC;IACpC,IAAID,KAAK,CAAC3B,MAAM,KAAK,CAAC,EAAE,OAAO,IAAI;IACnC,oBACEZ,OAAA;MAAK0B,SAAS,EAAC,UAAU;MAAAC,QAAA,EACtBY,KAAK,CAACoB,GAAG,CAACqF,IAAI,iBACbhJ,OAAA;QAEE0B,SAAS,EAAC,iBAAiB;QAC3BuH,OAAO,EAAEA,CAAA,KAAM9B,iBAAiB,CAAC6B,IAAI,CAAE;QAAArH,QAAA,EAEtCqH;MAAI,GAJAA,IAAI;QAAApH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAKH,CACT;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC;EAEV,CAAC;EAED,oBACE/B,OAAA;IAAK2I,KAAK,EAAE;MAAEO,UAAU,EAAE,oDAAoD;MAAEC,SAAS,EAAE;IAAQ,CAAE;IAAAxH,QAAA,gBACnG3B,OAAA;MACE0B,SAAS,EAAC,gCAAgC;MAC1CuH,OAAO,EAAEA,CAAA,KAAMtD,SAAS,CAAC,CAACD,MAAM,CAAE;MAClC,cAAW,gBAAgB;MAC3BiD,KAAK,EAAE;QAAES,QAAQ,EAAE,OAAO;QAAEC,KAAK,EAAE,MAAM;QAAEC,MAAM,EAAE,MAAM;QAAEC,MAAM,EAAE;MAAM,CAAE;MAAA5H,QAAA,EAC1E+D,MAAM,GAAG,GAAG,gBAAG1F,OAAA;QAAKwJ,GAAG,EAAE3J,WAAY;QAAC4J,GAAG,EAAC,SAAS;QAACd,KAAK,EAAE;UAAEe,KAAK,EAAE,EAAE;UAAEC,MAAM,EAAE;QAAG;MAAE;QAAA/H,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACnF,CAAC,EACR2D,MAAM,iBACL1F,OAAA;MACE0B,SAAS,EACP,wBAAwB,IACvBkE,QAAQ,GAAG,YAAY,GAAG,EAAE,CAAC,IAC7BE,UAAU,GAAG,WAAW,GAAG,YAAY,CACzC;MAAAnE,QAAA,gBAED3B,OAAA;QAAQ0B,SAAS,EAAC,gBAAgB;QAAAC,QAAA,gBAChC3B,OAAA;UAAM0B,SAAS,EAAC,cAAc;UAAAC,QAAA,GAAC,gBACf,eAAA3B,OAAA;YAAM0B,SAAS,EAAC,uBAAuB;YAAAC,QAAA,EAAC;UAAU;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnE,CAAC,eACP/B,OAAA;UAAK0B,SAAS,EAAC,iBAAiB;UAAAC,QAAA,eAC9B3B,OAAA;YAAK0B,SAAS,EAAC,gBAAgB;YAAAC,QAAA,gBAC7B3B,OAAA;cAAQiJ,OAAO,EAAER,WAAY;cAACmB,KAAK,EAAC,cAAc;cAAClI,SAAS,EAAC,mBAAmB;cAAC,cAAW,cAAc;cAAAC,QAAA,EACvGiE,QAAQ,gBACP5F,OAAA;gBAAK0J,KAAK,EAAC,IAAI;gBAACC,MAAM,EAAC,IAAI;gBAACE,OAAO,EAAC,WAAW;gBAACC,IAAI,EAAC,MAAM;gBAAAnI,QAAA,gBACzD3B,OAAA;kBAAQ+J,EAAE,EAAC,IAAI;kBAACC,EAAE,EAAC,IAAI;kBAACC,CAAC,EAAC,GAAG;kBAACH,IAAI,EAAC;gBAAS;kBAAAlI,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,eAC/C/B,OAAA;kBAAGkK,MAAM,EAAC,SAAS;kBAACC,WAAW,EAAC,GAAG;kBAAAxI,QAAA,gBACjC3B,OAAA;oBAAMoK,EAAE,EAAC,IAAI;oBAACC,EAAE,EAAC,GAAG;oBAACC,EAAE,EAAC,IAAI;oBAACC,EAAE,EAAC;kBAAG;oBAAA3I,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,eACtC/B,OAAA;oBAAMoK,EAAE,EAAC,IAAI;oBAACC,EAAE,EAAC,IAAI;oBAACC,EAAE,EAAC,IAAI;oBAACC,EAAE,EAAC;kBAAI;oBAAA3I,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,eACxC/B,OAAA;oBAAMoK,EAAE,EAAC,MAAM;oBAACC,EAAE,EAAC,MAAM;oBAACC,EAAE,EAAC,MAAM;oBAACC,EAAE,EAAC;kBAAM;oBAAA3I,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,eAChD/B,OAAA;oBAAMoK,EAAE,EAAC,OAAO;oBAACC,EAAE,EAAC,OAAO;oBAACC,EAAE,EAAC,OAAO;oBAACC,EAAE,EAAC;kBAAO;oBAAA3I,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,eACpD/B,OAAA;oBAAMoK,EAAE,EAAC,GAAG;oBAACC,EAAE,EAAC,IAAI;oBAACC,EAAE,EAAC,GAAG;oBAACC,EAAE,EAAC;kBAAI;oBAAA3I,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,eACtC/B,OAAA;oBAAMoK,EAAE,EAAC,IAAI;oBAACC,EAAE,EAAC,IAAI;oBAACC,EAAE,EAAC,IAAI;oBAACC,EAAE,EAAC;kBAAI;oBAAA3I,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,eACxC/B,OAAA;oBAAMoK,EAAE,EAAC,MAAM;oBAACC,EAAE,EAAC,OAAO;oBAACC,EAAE,EAAC,MAAM;oBAACC,EAAE,EAAC;kBAAO;oBAAA3I,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,eAClD/B,OAAA;oBAAMoK,EAAE,EAAC,OAAO;oBAACC,EAAE,EAAC,MAAM;oBAACC,EAAE,EAAC,OAAO;oBAACC,EAAE,EAAC;kBAAM;oBAAA3I,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACjD,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACD,CAAC,gBAEN/B,OAAA;gBAAK0J,KAAK,EAAC,IAAI;gBAACC,MAAM,EAAC,IAAI;gBAACE,OAAO,EAAC,WAAW;gBAACC,IAAI,EAAC,MAAM;gBAAAnI,QAAA,eACzD3B,OAAA;kBAAMwK,CAAC,EAAC,+CAA+C;kBAACV,IAAI,EAAC;gBAAS;kBAAAlI,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACtE;YACN;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACK,CAAC,eACT/B,OAAA;cACEiJ,OAAO,EAAEA,CAAA,KAAM;gBACb/D,WAAW,CAAC,CAAC;kBAAEtB,IAAI,EAAE,WAAW;kBAAE1B,IAAI,EAAE;gBAAkC,CAAC,CAAC,CAAC;gBAC7EkD,YAAY,CAACqF,UAAU,CAAC,cAAc,CAAC;gBACvClF,WAAW,CAAC,CAAC,CAAC,CAAC;cACjB,CAAE;cACFqE,KAAK,EAAC,YAAY;cAClBlI,SAAS,EAAC,mBAAmB;cAC7B,cAAW,YAAY;cAAAC,QAAA,eAEvB3B,OAAA;gBAAK0J,KAAK,EAAC,IAAI;gBAACC,MAAM,EAAC,IAAI;gBAACG,IAAI,EAAC,MAAM;gBAACI,MAAM,EAAC,SAAS;gBAACC,WAAW,EAAC,KAAK;gBAACN,OAAO,EAAC,WAAW;gBAAAlI,QAAA,eAC5F3B,OAAA;kBAAMwK,CAAC,EAAC,wCAAwC;kBAACE,aAAa,EAAC,OAAO;kBAACC,cAAc,EAAC;gBAAO;kBAAA/I,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC7F;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACA,CAAC,eACT/B,OAAA;cACEiJ,OAAO,EAAEA,CAAA,KAAMlD,aAAa,CAAEmC,IAAI,IAAK,CAACA,IAAI,CAAE;cAC9C0B,KAAK,EAAE9D,UAAU,GAAG,iBAAiB,GAAG,eAAgB;cACxDpE,SAAS,EAAC,mBAAmB;cAC7B,cAAYoE,UAAU,GAAG,iBAAiB,GAAG,eAAgB;cAAAnE,QAAA,EAE5DmE,UAAU,gBACT9F,OAAA;gBAAK0J,KAAK,EAAC,IAAI;gBAACC,MAAM,EAAC,IAAI;gBAACG,IAAI,EAAC,MAAM;gBAACI,MAAM,EAAC,SAAS;gBAACC,WAAW,EAAC,KAAK;gBAACN,OAAO,EAAC,WAAW;gBAAAlI,QAAA,gBAC5F3B,OAAA;kBAAU4K,MAAM,EAAC;gBAAa;kBAAAhJ,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,eACjC/B,OAAA;kBAAMoK,EAAE,EAAC,GAAG;kBAACC,EAAE,EAAC,GAAG;kBAACC,EAAE,EAAC,IAAI;kBAACC,EAAE,EAAC;gBAAI;kBAAA3I,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,eACtC/B,OAAA;kBAAU4K,MAAM,EAAC;gBAAmB;kBAAAhJ,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,eACvC/B,OAAA;kBAAMoK,EAAE,EAAC,IAAI;kBAACC,EAAE,EAAC,IAAI;kBAACC,EAAE,EAAC,IAAI;kBAACC,EAAE,EAAC;gBAAI;kBAAA3I,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACrC,CAAC,gBAEN/B,OAAA;gBAAK0J,KAAK,EAAC,IAAI;gBAACC,MAAM,EAAC,IAAI;gBAACG,IAAI,EAAC,MAAM;gBAACI,MAAM,EAAC,SAAS;gBAACC,WAAW,EAAC,KAAK;gBAACN,OAAO,EAAC,WAAW;gBAAAlI,QAAA,gBAC5F3B,OAAA;kBAAU4K,MAAM,EAAC;gBAAgB;kBAAAhJ,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,eACpC/B,OAAA;kBAAMoK,EAAE,EAAC,IAAI;kBAACC,EAAE,EAAC,GAAG;kBAACC,EAAE,EAAC,IAAI;kBAACC,EAAE,EAAC;gBAAI;kBAAA3I,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,eACvC/B,OAAA;kBAAU4K,MAAM,EAAC;gBAAgB;kBAAAhJ,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,eACpC/B,OAAA;kBAAMoK,EAAE,EAAC,GAAG;kBAACC,EAAE,EAAC,IAAI;kBAACC,EAAE,EAAC,IAAI;kBAACC,EAAE,EAAC;gBAAI;kBAAA3I,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACpC;YACN;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACK,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACA,CAAC,eACT/B,OAAA;QAAI0B,SAAS,EAAC,SAAS;QAACmJ,GAAG,EAAExE,OAAQ;QAAA1E,QAAA,GAClC6B,QAAQ,CAACG,GAAG,CAAC,CAACnB,GAAG,EAAEgG,GAAG,kBACrBxI,OAAA;UAEE0B,SAAS,EAAE,QAAQc,GAAG,CAACoB,IAAI,KAAK,MAAM,GAAG,UAAU,GAAG,UAAU,EAAG;UACnE+E,KAAK,EAAE;YAAEmC,cAAc,EAAEtI,GAAG,CAACoB,IAAI,KAAK,MAAM,GAAG,UAAU,GAAG;UAAa,CAAE;UAAAjC,QAAA,gBAE3E3B,OAAA;YAAK0B,SAAS,EAAE,eAAec,GAAG,CAACoB,IAAI,EAAG;YAAAjC,QAAA,EACvC+G,uBAAuB,CAAClG,GAAG;UAAC;YAAAZ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC1B,CAAC,EAELS,GAAG,CAACoB,IAAI,KAAK,WAAW,iBACvB5D,OAAA;YAAK0B,SAAS,EAAC,cAAc;YAAAC,QAAA,GAC1B2D,QAAQ,CAACkD,GAAG,CAAC,KAAKuC,SAAS,iBAC1B/K,OAAA,CAAAE,SAAA;cAAAyB,QAAA,gBACE3B,OAAA,CAACiC,OAAO;gBAACC,IAAI,EAAC,iBAAiB;gBAAAP,QAAA,eAC7B3B,OAAA;kBACE0B,SAAS,EAAC,cAAc;kBACxBuH,OAAO,EAAEA,CAAA,KAAMV,cAAc,CAACC,GAAG,EAAE,IAAI,CAAE;kBACzC,cAAW,WAAW;kBACtBwC,QAAQ,EAAE,CAAE;kBAAArJ,QAAA,EACb;gBAAE;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACL,CAAC,eACV/B,OAAA,CAACiC,OAAO;gBAACC,IAAI,EAAC,qBAAqB;gBAAAP,QAAA,eACjC3B,OAAA;kBACE0B,SAAS,EAAC,cAAc;kBACxBuH,OAAO,EAAEA,CAAA,KAAMV,cAAc,CAACC,GAAG,EAAE,MAAM,CAAE;kBAC3C,cAAW,aAAa;kBACxBwC,QAAQ,EAAE,CAAE;kBAAArJ,QAAA,EACb;gBAAE;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACL,CAAC;YAAA,eACV,CACH,EACAuD,QAAQ,CAACkD,GAAG,CAAC,KAAK,IAAI,iBACrBxI,OAAA,CAACiC,OAAO;cAACC,IAAI,EAAC,oBAAoB;cAAAP,QAAA,eAChC3B,OAAA;gBAAQ0B,SAAS,EAAC,0BAA0B;gBAAC,cAAW,WAAW;gBAACsJ,QAAQ,EAAE,CAAE;gBAAArJ,QAAA,EAAC;cAAE;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACrF,CACV,EACAuD,QAAQ,CAACkD,GAAG,CAAC,KAAK,MAAM,iBACvBxI,OAAA,CAACiC,OAAO;cAACC,IAAI,EAAC,uBAAuB;cAAAP,QAAA,eACnC3B,OAAA;gBAAQ0B,SAAS,EAAC,4BAA4B;gBAAC,cAAW,aAAa;gBAACsJ,QAAQ,EAAE,CAAE;gBAAArJ,QAAA,EAAC;cAAE;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACzF,CACV;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CACN,EAEAgH,kBAAkB,CAACvG,GAAG,EAAEgG,GAAG,CAAC;QAAA,GA3CxBA,GAAG;UAAA5G,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OA4CN,CACL,CAAC,EACDoE,QAAQ,iBACPnG,OAAA;UAAI0B,SAAS,EAAC,eAAe;UAAAC,QAAA,eAC3B3B,OAAA;YAAK0B,SAAS,EAAC,uBAAuB;YAAAC,QAAA,eACpC3B,OAAA,CAACyB,eAAe;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAChB;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACJ,CACL;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,eACL/B,OAAA;QAAK0B,SAAS,EAAC,YAAY;QAAAC,QAAA,gBACzB3B,OAAA;UACE6K,GAAG,EAAEvE,QAAS;UACd2E,WAAW,EAAC,oBAAoB;UAChC/J,KAAK,EAAEsE,KAAM;UACb0F,QAAQ,EAAEC,CAAC,IAAI1F,QAAQ,CAAC0F,CAAC,CAACC,MAAM,CAAClK,KAAK,CAAE;UACxCmK,SAAS,EAAEF,CAAC,IAAI;YACd,IAAIA,CAAC,CAACG,GAAG,KAAK,OAAO,IAAI,CAACH,CAAC,CAACI,QAAQ,EAAE;cACpCJ,CAAC,CAACK,cAAc,CAAC,CAAC;cAClBrE,iBAAiB,CAAC3B,KAAK,CAAC;YAC1B;UACF,CAAE;UACFiG,IAAI,EAAE,CAAE;UACR/J,SAAS,EAAC,qBAAqB;UAC/BiH,KAAK,EAAE;YAAE+C,QAAQ,EAAE,QAAQ;YAAEC,MAAM,EAAE;UAAO,CAAE;UAC9CC,QAAQ,EAAEzF,QAAS;UACnB0F,SAAS,EAAEnG,MAAO;UAClB,cAAW;QAAmB;UAAA9D,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC/B,CAAC,eACF/B,OAAA;UACEiJ,OAAO,EAAEA,CAAA,KAAM9B,iBAAiB,CAAC3B,KAAK,CAAE;UACxCoE,KAAK,EAAC,cAAc;UACpBlI,SAAS,EAAE,cAAc8D,KAAK,CAAC3E,IAAI,CAAC,CAAC,GAAG,WAAW,GAAG,EAAE,EAAG;UAC3D+K,QAAQ,EAAEzF,QAAQ,IAAI,CAACX,KAAK,CAAC3E,IAAI,CAAC,CAAE;UACpC,cAAW,MAAM;UAAAc,QAAA,eAEjB3B,OAAA;YAAK2J,MAAM,EAAC,IAAI;YAACD,KAAK,EAAC,IAAI;YAACG,OAAO,EAAC,WAAW;YAACC,IAAI,EAAC,MAAM;YAACnB,KAAK,EAAE;cAAEmD,OAAO,EAAE;YAAQ,CAAE;YAAAnK,QAAA,eACtF3B,OAAA;cAAMwK,CAAC,EAAC,mCAAmC;cAACV,IAAI,EAAC;YAAc;cAAAlI,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC/D;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACA,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC,eAChB/B,OAAA;QACE0B,SAAS,EAAC,gBAAgB;QAC1BiH,KAAK,EAAE;UACLmD,OAAO,EAAE,MAAM;UACfC,UAAU,EAAE,QAAQ;UACpBjB,cAAc,EAAE,QAAQ;UACxB1B,QAAQ,EAAE,UAAU;UACpBM,KAAK,EAAE,MAAM;UACbP,SAAS,EAAE,MAAM;UACjB6C,OAAO,EAAE;QACX,CAAE;QAAArK,QAAA,gBAGF3B,OAAA;UACEiJ,OAAO,EAAEA,CAAA,KAAM1F,YAAY,CAACC,QAAQ,CAAE;UACtCoG,KAAK,EAAC,uBAAuB;UAC7BlI,SAAS,EAAC,mBAAmB;UAC7B,cAAW,eAAe;UAC1BiH,KAAK,EAAE;YACLS,QAAQ,EAAE,UAAU;YACpB6C,IAAI,EAAE,CAAC;YACPvF,GAAG,EAAE,KAAK;YACVwF,SAAS,EAAE,kBAAkB;YAC7BhD,UAAU,EAAE,MAAM;YAClBiD,MAAM,EAAE,MAAM;YACdC,MAAM,EAAE,SAAS;YACjBJ,OAAO,EAAE,YAAY;YACrBrC,MAAM,EAAE,MAAM;YACdmC,OAAO,EAAE,MAAM;YACfC,UAAU,EAAE;UACd,CAAE;UAAApK,QAAA,eAEF3B,OAAA;YAAK0J,KAAK,EAAC,IAAI;YAACC,MAAM,EAAC,IAAI;YAACG,IAAI,EAAC,MAAM;YAACD,OAAO,EAAC,WAAW;YAAAlI,QAAA,eACzD3B,OAAA;cAAMwK,CAAC,EAAC,wCAAwC;cAACN,MAAM,EAAC,SAAS;cAACC,WAAW,EAAC,GAAG;cAACO,aAAa,EAAC,OAAO;cAACC,cAAc,EAAC;YAAO;cAAA/I,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAC;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC7H;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACA,CAAC,eAET/B,OAAA;UAAM2I,KAAK,EAAE;YAAEmD,OAAO,EAAE,MAAM;YAAEC,UAAU,EAAE,QAAQ;YAAEjB,cAAc,EAAE;UAAS,CAAE;UAAAnJ,QAAA,GAAC,aACrE,eAAA3B,OAAA;YAAKwJ,GAAG,EAAE1J,MAAO;YAAC2J,GAAG,EAAC,eAAe;YAACd,KAAK,EAAE;cAAE0D,UAAU,EAAE,CAAC;cAAE1C,MAAM,EAAE;YAAG;UAAE;YAAA/H,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACrF,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACI,CACN;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV,CAAC;AAACkD,EAAA,CA5WID,OAAO;AAAAsH,GAAA,GAAPtH,OAAO;AA8Wb,eAAeA,OAAO;AAAC,IAAAhD,EAAA,EAAAG,GAAA,EAAAmK,GAAA;AAAAC,YAAA,CAAAvK,EAAA;AAAAuK,YAAA,CAAApK,GAAA;AAAAoK,YAAA,CAAAD,GAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}